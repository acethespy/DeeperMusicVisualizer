/*
Polynomial.js v1.4.3 13/12/2017

Copyright (c) 2017, Robert Eisele (robert@xarg.org)
Dual licensed under the MIT or GPL Version 2 licenses.
*/
(function(v){function z(a){return function(){var b=this.coeff,d=[];for(c in b)d.push(+c);if(0===d.length)return"0";d.sort(function(a,c){return a-c});var c="";for(var g=d.length;g--;){var h=d[g],e=b[h],k=e;if(null!==k&&void 0!==k)if(m&&k instanceof m){if(0!==k.re){""!==c&&0<k.re&&(c+="+");if(-1===k.re&&0!==h)c+="-";else if(1!==k.re||0===h)c+=k.re;1===h?c+="x":0!==h&&(c+="x^"+h)}0!==k.im&&(""!==c&&0<k.im&&(c+="+"),-1===k.im?c+="-":1!==k.im&&(c+=k.im),c+="i",1===h?c+="x":0!==h&&(c+="x^"+h))}else if(k=
k.valueOf(),0!==k){""!==c&&0<k&&(c+="+");if(-1===k&&0!==h)c+="-";else if(1!==k||0===h)c+=e[a]?e[a]():e.toString();1===h?c+="x":0!==h&&(c+="x^"+h)}}return""===c?cur[a]?cur[a]():cur.toString():c}}function n(a){var b={};if(null===a||void 0===a)a=0;switch(typeof a){case "object":a.coeff&&(a=a.coeff);if(q&&a instanceof q||m&&a instanceof m||t&&a instanceof t)b[0]=a;else for(var d in a)f.empty(a[d])||(b[d]=f.parse(a[d]));return b;case "number":return{0:f.parse(a)};case "string":for(;null!==(d=E.exec(a));){var c=
1,g=1;void 0!==d[4]?(c=d[4],g=0):void 0!==d[2]&&(c=d[2]);var h=d[1];c=String(c).match(/[^*/]+|[*/]/g);h=f.parse(h+c[0]);for(var e=1;e<c.length;e+=2)"*"===c[e]?h=f.mul(h,f.parse(c[e+1]||1)):"/"===c[e]&&(h=f.div(h,f.parse(c[e+1]||1)));c=h;void 0!==d[3]&&(g=parseInt(d[3],10));b[g]=void 0===b[g]?c:f.add(b[g],c)}return b}throw"Invalid Param";}function y(a,b){for(var d={},c=p(a),g=p(b),h=[];c>=g;){var l=d[c-g]=f.div(a[c]||0,b[g]||0),k;for(k in b)a[+k+c-g]=f.sub(a[+k+c-g]||0,f.mul(b[k]||0,l));if(null!==
e.trace){var A={},x;for(x in b)A[+x+c-g]=f.mul(b[x]||0,l);h.push(new e(A))}c=p(a)}null!==e.trace&&(h.push(new e(a)),e.trace=h);return d}function B(a,b){var d=1;for(b=a-b;b<a;a--)d*=a;return d}function e(a){if(!(this instanceof e))return new e(a);this.coeff=n(a)}function u(a){var b={},d;for(d in a)b[d]=a[d];return b}function C(a,b){var d={},c;for(c in a)d[c]=1;for(var e in b)d[e]=1;return d}function p(a){var b=Number.NEGATIVE_INFINITY,d;for(d in a)f.empty(a[d])||(b=Math.max(d,b));return b}function w(a){var b=
null,d;for(d in a)!f.empty(a[d])&&(null===b||+b<+d)&&(b=d);return b}function D(a,b){if(null!==b)for(var d in a)a[d]=f.div(a[d],a[b]);return a}var f={add:function(a,b){return a+b},sub:function(a,b){return a-b},mul:function(a,b){return a*b},div:function(a,b){if(0===b)throw"DIV/0";return a/b},parse:function(a){return parseFloat(a)},empty:function(a){return!a},pow:function(a,b){return Math.pow(a,b)},equals:function(a,b){return a===b}},F=f,E=/([+-]?)(?:([^+x-]+)?(?:x(?:\^([\d\/]+))?)|([^+x-]+))/g;e.trace=
null;e.prototype.coeff={};e.prototype.gcd=function(a){var b=u(this.coeff);for(a=n(a);p(a)!==Number.NEGATIVE_INFINITY;){var d=u(b);y(d,a);b=a;a=d}a=w(b);return new e(D(b,a))};e.prototype.neg=function(){var a={},b=this.coeff,d;for(d in b)a[d]=f.mul(b[d],-1);return new e(a)};e.prototype.reciprocal=function(){var a={},b=this.coeff,d=p(b),c;for(c in b)a[d-c]=b[c];return new e(a)};e.prototype.eval=function(a){var b=this.coeff,d=p(b),c=b[d];for(--d;0<=d;d--)c=f.mul(c,a),f.empty(b[d])||(c=f.add(c,b[d]));
return c};e.prototype.lc=function(){var a=w(this.coeff);return this.coeff[a]};e.prototype.lm=function(){var a=w(this.coeff),b={};b[a]=this.coeff[a];return new e(b)};e.prototype.monic=function(){return new e(D(u(this.coeff),w(this.coeff)))};e.prototype.add=function(a){a=n(a);var b={},d=this.coeff,c=C(a,d),g;for(g in c)b[g]=f.add(d[g]||0,a[g]||0);return new e(b)};e.prototype.sub=function(a){a=n(a);var b={},d=this.coeff,c=C(a,d),g;for(g in c)b[g]=f.sub(d[g]||0,a[g]||0);return new e(b)};e.prototype.mul=
function(a){a=n(a);var b={},d=this.coeff;for(c in a){var c=+c;for(var g in d)g=+g,b[c+g]=f.add(b[c+g]||0,f.mul(a[c]||0,d[g]||0))}return new e(b)};e.prototype.addmul=function(a,b){var d=n(a),c=n(b),e={};for(h in d){var h=+h;for(var l in c)l=+l,e[h+l]=f.add(e[h+l]||0,f.mul(d[h]||0,c[l]||0))}return this.add(e)};e.prototype.div=function(a){return new e(y(u(this.coeff),n(a)))};e.prototype.pow=function(a){if(isNaN(a)||0>a||a%1)throw"Invalid";for(var b=new e(1),d=this;0<a;)a&1&&(b=b.mul(d)),d=d.mul(d),a>>=
1;return b};e.prototype.mod=function(a){var b=u(this.coeff);y(b,n(a));return new e(b)};e.prototype.derive=function(a){if(void 0===a)a=1;else if(0>a)return null;var b=this.coeff,d={},c;for(c in b)+c>=a&&(d[c-a]=f.mul(b[c]||0,B(+c,a)));return new e(d)};e.prototype.integrate=function(a){if(void 0===a)a=1;else if(0>a)return null;var b=this.coeff,d={},c;for(c in b)d[+c+a]=f.div(b[c]||0,B(+c+a,a));return new e(d)};e.prototype.result=e.prototype.eval;e.fromRoots=function(a){function b(a){switch(a.length){case 0:return g;
case 1:return new e([f.mul(a[0],-1),1]);default:var c=Math.floor(a.length/2),d=a.slice(c,a.length);return b(a.slice(0,c)).a(b(d))}}var d=a.length,c=f.parse(0);a=a.filter(function(a){return!f.equals(a,c)});d-=a.length;var g=new e(f.parse(1));a=b(a).coeff;var h={},l;for(l in a)h[d+parseInt(l,10)]=a[l];return new e(h)};e.prototype.toString=z("toString");e.prototype.toLatex=z("toLatex");e.prototype.toHorner=function(){function a(a,c){var b="";m&&a instanceof m?0===a.im?(0<a.re&&c&&(b+="+"),b+=a.re):0===
a.re?(-1===a.im?b+="-":1!==a.im?(0<a.im&&c&&(b+="+"),b+=a.im):0<a.im&&c&&(b+="+"),b+="i"):(c&&(b+="+"),b=b+"("+a.toString(),b+=")"):(0<a&&c&&(b+="+"),b+=a.toString());return b}function b(c,e){var g=c.length-e-1,h=c[g]-(c[g-1]||0),f="",l="";0<h&&(f="x",1<h&&(f+="^"+h));0<g&&(f+=a(d[c[g-1]],!0));if(0===e)return a(d[c[g]],!1)+f;0<=g&&c[g]&&(l+="(");l+=b(c,e-1);0<=g&&c[g]&&(l+=")");return l+f}var d=this.coeff,c=[],e;for(e in d)f.empty(d[e])||c.push(+e);if(0===c.length)return"0";c.sort(function(a,c){return a-
c});return b(c,c.length-1)};e.prototype.clone=function(){return new e(this)};e.prototype.degree=function(){return p(this.coeff)};e.setField=function(a){var b={Q:q,C:m,H:t}[a];if(void 0!==b)f={add:function(a,d){return(new b(a)).add(d)},sub:function(a,d){return(new b(a)).sub(d)},mul:function(a,d){return(new b(a)).mul(d)},div:function(a,d){return(new b(a)).div(d)},parse:function(a){return new b(a)},empty:function(a){return(new b(a)).equals(0)},pow:function(a,d){return(new b(a)).pow(d)},equals:function(a,
d){return(new b(a)).equals(d)}};else if(!a||"R"===a)f=F;else if("object"===typeof a)f=a;else if("Z"===a.charAt(0)){var d=+a.slice(1);f={add:function(a,b){return((a+b)%d+d)%d},sub:function(a,b){return((a-b)%d+d)%d},mul:function(a,b){return(a*b%d+d)%d},div:function(a,b){for(var c=b,e=d,g=0,f=1,m=1,n=0;0!==c;){var p=e/c|0,q=e%c,t=g-m*p;p=f-n*p;e=c;c=q;g=m;f=n;m=t;n=p}c=[e,g,f];if(1!==c[0])throw"DIV/-";return(a*c[1]%d+d)%d},parse:function(a){return parseInt(a,10)},empty:function(a){return void 0===a||
0===a},pow:function(a,b){for(;0<b;b>>=1);return r},equals:function(a,b){return a==b}}}};if("function"===typeof define&&define.amd)define(["fraction.js","complex.js","quaternion"],function(a,b,d){q=a;m=b;t=d;return e});else if("object"===typeof exports){var q=require("fraction.js");var m=require("complex.js");var t=require("quaternion");Object.defineProperty(exports,"__esModule",{value:!0});e["default"]=e;e.Polynomial=e;module.exports=e}else q=v.Fraction,m=v.Complex,t=v.Quaternion,v.Polynomial=e})(this);